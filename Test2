import os
import ctypes
import subprocess
import getpass

PASSWORD = "1234"

def is_admin():
    try:
        return ctypes.windll.shell32.IsUserAnAdmin()
    except:
        return False

def hide_with_acl(path):
    ctypes.windll.kernel32.SetFileAttributesW(path, 0x02)
    subprocess.run(['icacls', path, '/deny', 'Everyone:(OI)(CI)F'], shell=True)
    print(f"‚úÖ ‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡∏ã‡πà‡∏≠‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå: {path}")

def unhide_with_acl(path):
    subprocess.run(['icacls', path, '/remove:d', 'Everyone'], shell=True)
    ctypes.windll.kernel32.SetFileAttributesW(path, 0x80)
    print(f"‚úÖ ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå: {path}")

def ask_password():
    for _ in range(3):
        input_password = getpass.getpass("üîê ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô: ")
        if input_password == PASSWORD:
            return True
        else:
            print("‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!")
    return False

def main():
    if not is_admin():
        print("‚ùó ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Administrator (Run as administrator)")
        return

    if not ask_password():
        print("‚ùå ‡∏õ‡∏¥‡∏î‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°")
        return

    print("\n‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö:")
    print("  l <‡∏û‡∏≤‡∏ò‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå>  - ‡∏•‡πá‡∏≠‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå")
    print("  u <‡∏û‡∏≤‡∏ò‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå>  - ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå")
    print("  exit               - ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°\n")

    while True:
        command = input("‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á > ").strip()
        if not command:
            continue
        parts = command.split(maxsplit=1)
        cmd = parts[0].lower()

        if cmd == "exit":
            print("üëã ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏£‡∏±‡∏ö!")
            break

        if len(parts) != 2:
            print("‚ùå ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå: l D:\\Folder ‡∏´‡∏£‡∏∑‡∏≠ u D:\\Folder")
            continue

        folder_path = parts[1]

        if not os.path.exists(folder_path):
            print("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ")
            continue

        if cmd == "l":
            hide_with_acl(folder_path)
        elif cmd == "u":
            unhide_with_acl(folder_path)
        else:
            print("‚ùå ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÉ‡∏ä‡πâ l, u ‡∏´‡∏£‡∏∑‡∏≠ exit ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)")

if __name__ == "__main__":
    main()
